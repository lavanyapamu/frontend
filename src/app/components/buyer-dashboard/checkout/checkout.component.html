<!-- <div class="checkout-container">

  <div class="progress-indicator">
    <div class="step" [ngClass]="getStepClass(1)">
      <div class="step-icon">
        <span *ngIf="!isStepCompleted(1)">1</span>
        <span *ngIf="isStepCompleted(1)" class="checkmark">✓</span>
      </div>
      <span class="step-label">BILLING INFORMATION</span>
    </div>
    
    <div class="step" [ngClass]="getStepClass(2)">
      <div class="step-icon">
        <span *ngIf="!isStepCompleted(2)">2</span>
        <span *ngIf="isStepCompleted(2)" class="checkmark">✓</span>
      </div>
      <span class="step-label">SHIPPING METHOD</span>
    </div>
    
    <div class="step" [ngClass]="getStepClass(3)">
      <div class="step-icon">
        <span *ngIf="!isStepCompleted(3)">3</span>
        <span *ngIf="isStepCompleted(3)" class="checkmark">✓</span>
      </div>
      <span class="step-label">PAYMENT INFORMATION</span>
    </div>
    
    <div class="step" [ngClass]="getStepClass(4)">
      <div class="step-icon">
        <span *ngIf="!isStepCompleted(4)">4</span>
        <span *ngIf="isStepCompleted(4)" class="checkmark">✓</span>
      </div>
      <span class="step-label">ORDER REVIEW</span>
    </div>
  </div>

  
  <div *ngIf="currentStep === 1" class="step-content">
    <form [formGroup]="billingForm" class="billing-form">
      <div class="form-row">
        <div class="form-group half">
          <label for="firstName">Full Name <span class="required">*</span></label>
          <input 
            id="firstName"
            type="text" 
            formControlName="firstName" 
            class="form-control"
            [class.error]="billingForm.get('firstName')?.invalid && billingForm.get('firstName')?.touched"
          />
          <div *ngIf="billingForm.get('firstName')?.invalid && billingForm.get('firstName')?.touched" class="error-message">
            First name is required
          </div>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group half">
          <label for="city">City <span class="required">*</span></label>
          <input 
            id="city"
            type="text" 
            formControlName="city" 
            class="form-control"
            [class.error]="billingForm.get('city')?.invalid && billingForm.get('city')?.touched"
          />
          <div *ngIf="billingForm.get('city')?.invalid && billingForm.get('city')?.touched" class="error-message">
            City is required
          </div>
        </div>
        
        <div class="form-group half">
          <label for="zipCode">Zip/Postal Code <span class="required">*</span></label>
          <input 
            id="zipCode"
            type="text" 
            formControlName="zipCode" 
            class="form-control"
            [class.error]="billingForm.get('zipCode')?.invalid && billingForm.get('zipCode')?.touched"
          />
          <div *ngIf="billingForm.get('zipCode')?.invalid && billingForm.get('zipCode')?.touched" class="error-message">
            Valid 6-digit postal code is required
          </div>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group half">
          <label for="state">State/Province</label>
          <input id="state" type="text" formControlName="state" class="form-control" />
        </div>
        
        <div class="form-group half">
          <label for="country">Country <span class="required">*</span></label>
          <select id="country" formControlName="country" class="form-control">
            <option value="India">India</option>
          </select>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group half">
          <label for="phone">Phone Number<span class="required">*</span></label>
          <input 
            id="phone"
            type="tel" 
            formControlName="phone" 
            class="form-control"
            [class.error]="billingForm.get('phone')?.invalid && billingForm.get('phone')?.touched"
          />
          <div *ngIf="billingForm.get('phone')?.invalid && billingForm.get('phone')?.touched" class="error-message">
            Valid 10-digit phone number is required
          </div>
        </div>
        
      </div>

      <div class="form-group">
        <label for="email">Email <span class="required">*</span></label>
        <input 
          id="email"
          type="email" 
          formControlName="email" 
          class="form-control"
          [class.error]="billingForm.get('email')?.invalid && billingForm.get('email')?.touched"
        />
        <div *ngIf="billingForm.get('email')?.invalid && billingForm.get('email')?.touched" class="error-message">
          Valid email is required
        </div>
      </div>

      <div class="form-actions">
        <button type="button" class="btn btn-primary" (click)="nextStep()">CONTINUE</button>
      </div>
    </form>
  </div>

  
  <div *ngIf="currentStep === 2" class="step-content">
    <div class="shipping-method">
      <h3>Free Shipping</h3>
      <p class="shipping-info">Free ₹0</p>
      
      <div class="form-actions">
        <button type="button" class="btn btn-secondary" (click)="previousStep()">← BACK</button>
        <button type="button" class="btn btn-primary" (click)="nextStep()">CONTINUE</button>
      </div>
    </div>
  </div>

 
  <div *ngIf="currentStep === 3" class="step-content">
    <form [formGroup]="paymentForm" class="payment-form">
      <div class="payment-methods">
        <div class="payment-option" *ngFor="let method of paymentMethods">
          <label class="radio-label" [class.disabled]="!method.available">
            <input 
              type="radio" 
              [value]="method.value" 
              formControlName="paymentMethod"
              [disabled]="!method.available"
            />
            <span class="radio-custom"></span>
            {{ method.label }}
          </label>
        </div>
      </div>


      
      <div *ngIf="selectedPaymentMethod === 'upi'" class="upi-payment">
        <div class="form-group">
          <label for="upiId">UPI ID <span class="required">*</span></label>
          <input 
            id="upiId"
            type="text" 
            formControlName="upiId" 
            class="form-control"
            placeholder="example@upi"
            [class.error]="paymentForm.get('upiId')?.invalid && paymentForm.get('upiId')?.touched"
          />
        </div>
      </div>

      <div class="form-actions">
        <button type="button" class="btn btn-secondary" (click)="previousStep()">← BACK</button>
        <button type="button" class="btn btn-primary" (click)="nextStep()">CONTINUE</button>
      </div>
    </form>
  </div>

  
  <div *ngIf="currentStep === 4 && !orderNumber" class="step-content">
    <div class="order-review">
      <table class="order-table">
        <thead>
          <tr>
            <th>PRODUCT</th>
            <th>PRICE</th>
            <th>QTY</th>
            <th>SUBTOTAL</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of cartItems">
            <td>{{ item.artwork_name }}</td>
            <td>₹{{ item.price | number:'1.0-0' }}</td>
            <td>{{ item.quantity }}</td>
            <td>₹{{ (item.price * item.quantity) | number:'1.0-0' }}</td>
          </tr>
        </tbody>
      </table>

      <div class="order-totals">
        <div class="total-row">
          <span>Subtotal</span>
          <span>₹{{ subtotal | number:'1.0-0' }}</span>
        </div>
        <div class="total-row">
          <span>Shipping & Handling ({{ shippingFee === 0 ? 'Free Shipping - Free' : 'Standard Shipping' }})</span>
          <span>₹{{ shippingFee | number:'1.0-0' }}</span>
        </div>
        <div class="total-row">
          <span>Tax</span>
          <span>₹{{ tax | number:'1.0-0' }}</span>
        </div>
        <div class="total-row total">
          <span><strong>Total</strong></span>
          <span><strong>₹{{ total | number:'1.0-0' }}</strong></span>
        </div>
      </div>

      <div class="form-actions">
        <button type="button" class="btn btn-secondary" (click)="previousStep()">← BACK</button>
        <button type="button" class="btn btn-primary" (click)="placeOrder()" [disabled]="isProcessing">
          {{ isProcessing ? 'PROCESSING...' : 'PLACE ORDER' }}
        </button>
      </div>
    </div>
  </div>

 
  <div *ngIf="currentStep === 4 && orderNumber" class="order-confirmation">
    <div class="confirmation-header">
      <h1>ART SPEAKS WHERE WORDS ARE UNABLE TO EXPLAIN.</h1>
      <h2>YOUR ORDER HAS BEEN RECEIVED.</h2>
    </div>

    <div class="order-details">
      <p>Your order # is: <strong>{{ orderNumber }}</strong></p>
      <p>You will receive an order confirmation email with details of your order and a link to track its progress.</p>
      <p><a href="#" (click)="printOrderConfirmation()">Click here to print a copy of your order confirmation.</a></p>
    </div>

    <div class="confirmation-actions">
      <button type="button" class="btn btn-primary" (click)="continueShopping()">CONTINUE SHOPPING</button>
      <button type="button" class="btn btn-secondary" (click)="trackOrder()">TRACK YOUR ORDER</button>
    </div>

    <div class="rating-section">
      <p>Help Us Make Us Better</p>
      <div class="rating-stars">
        <span *ngFor="let i of [1,2,3,4,5,6,7,8,9,10]" class="star">{{ i }}</span>
      </div>
      <button type="button" class="btn btn-outline">RATE YOUR EXPERIENCE</button>
    </div>
  </div>
</div>
 -->
 <div class="checkout-container">
  <!-- Progress Indicator -->
  <div class="progress-indicator">
    <div class="step" [ngClass]="getStepClass(1)">
      <div class="step-icon">
        <span *ngIf="!isStepCompleted(1)">1</span>
        <span *ngIf="isStepCompleted(1)" class="checkmark">✓</span>
      </div>
      <span class="step-label">BILLING INFORMATION</span>
    </div>
    
    <div class="step" [ngClass]="getStepClass(2)">
      <div class="step-icon">
        <span *ngIf="!isStepCompleted(2)">2</span>
        <span *ngIf="isStepCompleted(2)" class="checkmark">✓</span>
      </div>
      <span class="step-label">SHIPPING METHOD</span>
    </div>
    
    <div class="step" [ngClass]="getStepClass(3)">
      <div class="step-icon">
        <span *ngIf="!isStepCompleted(3)">3</span>
        <span *ngIf="isStepCompleted(3)" class="checkmark">✓</span>
      </div>
      <span class="step-label">PAYMENT INFORMATION</span>
    </div>
    
    <div class="step" [ngClass]="getStepClass(4)">
      <div class="step-icon">
        <span *ngIf="!isStepCompleted(4)">4</span>
        <span *ngIf="isStepCompleted(4)" class="checkmark">✓</span>
      </div>
      <span class="step-label">ORDER REVIEW</span>
    </div>
  </div>

  <!-- Step 1: Billing Information -->
  <div *ngIf="currentStep === 1" class="step-content">
    <form [formGroup]="billingForm" class="billing-form">
      <div class="form-row">
        <div class="form-group full">
          <label for="firstName">Full Name <span class="required">*</span></label>
          <input 
            id="firstName"
            type="text" 
            formControlName="firstName" 
            class="form-control"
            [class.error]="billingForm.get('firstName')?.invalid && billingForm.get('firstName')?.touched"
          />
          <div *ngIf="billingForm.get('firstName')?.invalid && billingForm.get('firstName')?.touched" class="error-message">
            <span *ngIf="billingForm.get('firstName')?.errors?.['required']">Full name is required</span>
            <span *ngIf="billingForm.get('firstName')?.errors?.['minlength']">Full name must be at least 2 characters</span>
          </div>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group half">
          <label for="city">City <span class="required">*</span></label>
          <input 
            id="city"
            type="text" 
            formControlName="city" 
            class="form-control"
            [class.error]="billingForm.get('city')?.invalid && billingForm.get('city')?.touched"
          />
          <div *ngIf="billingForm.get('city')?.invalid && billingForm.get('city')?.touched" class="error-message">
            <span *ngIf="billingForm.get('city')?.errors?.['required']">City is required</span>
            <span *ngIf="billingForm.get('city')?.errors?.['minlength']">City must be at least 2 characters</span>
          </div>
        </div>
        
        <div class="form-group half">
          <label for="zipCode">Zip/Postal Code <span class="required">*</span></label>
          <input 
            id="zipCode"
            type="text" 
            formControlName="zipCode" 
            class="form-control"
            [class.error]="billingForm.get('zipCode')?.invalid && billingForm.get('zipCode')?.touched"
          />
          <div *ngIf="billingForm.get('zipCode')?.invalid && billingForm.get('zipCode')?.touched" class="error-message">
            <span *ngIf="billingForm.get('zipCode')?.errors?.['required']">Postal code is required</span>
            <span *ngIf="billingForm.get('zipCode')?.errors?.['pattern']">Valid 6-digit postal code is required</span>
          </div>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group half">
          <label for="state">State/Province</label>
          <input id="state" type="text" formControlName="state" class="form-control" />
        </div>
        
        <div class="form-group half">
          <label for="country">Country <span class="required">*</span></label>
          <select id="country" formControlName="country" class="form-control">
            <option value="India">India</option>
          </select>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group half">
          <label for="phone">Phone Number <span class="required">*</span></label>
          <input 
            id="phone"
            type="tel" 
            formControlName="phone" 
            class="form-control"
            [class.error]="billingForm.get('phone')?.invalid && billingForm.get('phone')?.touched"
          />
          <div *ngIf="billingForm.get('phone')?.invalid && billingForm.get('phone')?.touched" class="error-message">
            <span *ngIf="billingForm.get('phone')?.errors?.['required']">Phone number is required</span>
            <span *ngIf="billingForm.get('phone')?.errors?.['pattern']">Valid 10-digit phone number is required</span>
          </div>
        </div>
        
        <div class="form-group half">
          <label for="email">Email <span class="required">*</span></label>
          <input 
            id="email"
            type="email" 
            formControlName="email" 
            class="form-control"
            [class.error]="billingForm.get('email')?.invalid && billingForm.get('email')?.touched"
          />
          <div *ngIf="billingForm.get('email')?.invalid && billingForm.get('email')?.touched" class="error-message">
            <span *ngIf="billingForm.get('email')?.errors?.['required']">Email is required</span>
            <span *ngIf="billingForm.get('email')?.errors?.['email']">Valid email is required</span>
          </div>
        </div>
      </div>

      <div class="form-actions">
        <button type="button" class="btn btn-primary" (click)="nextStep()">CONTINUE</button>
      </div>
    </form>
  </div>

  <!-- Step 2: Shipping Method -->
  <div *ngIf="currentStep === 2" class="step-content">
    <div class="shipping-method">
      <h3>Shipping Method</h3>
      <div class="shipping-option">
        <div class="shipping-details">
          <h4>{{ shippingFee === 0 ? 'Free Shipping' : 'Standard Shipping' }}</h4>
          <p class="shipping-info">₹{{ shippingFee | number:'1.0-0' }}</p>
          <p class="shipping-note" *ngIf="shippingFee === 0">Free shipping on orders over ₹500</p>
        </div>
      </div>
      
      <div class="form-actions">
        <button type="button" class="btn btn-secondary" (click)="previousStep()">← BACK</button>
        <button type="button" class="btn btn-primary" (click)="nextStep()">CONTINUE</button>
      </div>
    </div>
  </div>

  <!-- Step 3: Payment Information -->
  <div *ngIf="currentStep === 3" class="step-content">
    <form [formGroup]="paymentForm" class="payment-form">
      <div class="payment-methods">
        <h3>Payment Method</h3>
        <div class="payment-option" *ngFor="let method of paymentMethods">
          <label class="radio-label" [class.disabled]="!method.available">
            <input 
              type="radio" 
              [value]="method.value" 
              formControlName="paymentMethod"
              [disabled]="!method.available"
            />
            <span class="radio-custom"></span>
            {{ method.label }}
          </label>
        </div>
      </div>

      <!-- UPI Payment Details -->
      <div *ngIf="selectedPaymentMethod === 'upi'" class="upi-payment">
        <div class="form-group">
          <label for="upiId">UPI ID <span class="required">*</span></label>
          <input 
            id="upiId"
            type="text" 
            formControlName="upiId" 
            class="form-control"
            placeholder="example@upi"
            [class.error]="paymentForm.get('upiId')?.invalid && paymentForm.get('upiId')?.touched"
          />
          <div *ngIf="paymentForm.get('upiId')?.invalid && paymentForm.get('upiId')?.touched" class="error-message">
            <span *ngIf="paymentForm.get('upiId')?.errors?.['required']">UPI ID is required</span>
            <span *ngIf="paymentForm.get('upiId')?.errors?.['pattern']">Please enter a valid UPI ID</span>
          </div>
        </div>
      </div>

      <!-- Wallet Payment Details -->
      <div *ngIf="selectedPaymentMethod === 'wallet'" class="wallet-payment">
        <div class="form-group">
          <label for="walletAmount">Wallet Amount to Use</label>
          <input 
            id="walletAmount"
            type="number" 
            formControlName="walletAmount" 
            class="form-control"
            min="0"
            [max]="total"
            placeholder="0"
          />
          <small class="help-text">Enter amount to use from wallet (optional)</small>
        </div>
      </div>

      <div class="form-actions">
        <button type="button" class="btn btn-secondary" (click)="previousStep()">← BACK</button>
        <button type="button" class="btn btn-primary" (click)="nextStep()">CONTINUE</button>
      </div>
    </form>
  </div>

  <!-- Step 4: Order Review -->
  <div *ngIf="currentStep === 4 && !orderNumber" class="step-content">
    <div class="order-review">
      <h3>Order Summary</h3>
      
      <!-- Cart Items with Delete Option -->
      <div class="cart-items-review">
        <div class="cart-item" *ngFor="let item of cartItems">
          <div class="item-image">
            <img 
  *ngIf="item.image_url" 
  [src]="item.image_url" 
  (error)="item.image_url = null" 
  alt="Artwork"
  width="100" height="100"
/>

          </div>
          <div class="item-details">
            <h4>{{ item.artwork_name }}</h4>
            <p class="item-price">₹{{ item.price | number:'1.0-0' }} × {{ item.quantity }}</p>
            <div class="quantity-controls">
              <button type="button" class="qty-btn" (click)="updateCartItemQuantity(item.cart_id, item.quantity - 1)">-</button>
              <span class="quantity">{{ item.quantity }}</span>
              <button type="button" class="qty-btn" (click)="updateCartItemQuantity(item.cart_id, item.quantity + 1)">+</button>
            </div>
          </div>
          <div class="item-total">
            <span class="total-price">₹{{ (item.price * item.quantity) | number:'1.0-0' }}</span>
            <button type="button" class="delete-btn" (click)="deleteCartItem(item.cart_id)" title="Remove item">
              🗑️
            </button>
          </div>
        </div>
      </div>

      <!-- Order Totals -->
      <div class="order-totals">
        <div class="total-row">
          <span>Subtotal</span>
          <span>₹{{ subtotal | number:'1.0-0' }}</span>
        </div>
        <div class="total-row">
          <span>Shipping & Handling ({{ shippingFee === 0 ? 'Free Shipping' : 'Standard Shipping' }})</span>
          <span>₹{{ shippingFee | number:'1.0-0' }}</span>
        </div>
        <div class="total-row total">
          <span><strong>Total</strong></span>
          <span><strong>₹{{ total | number:'1.0-0' }}</strong></span>
        </div>
      </div>

      <!-- Payment Summary -->
      <div class="payment-summary">
        <h4>Payment Method: {{ getSelectedPaymentLabel() }}</h4>
        <div *ngIf="selectedPaymentMethod === 'upi' && paymentForm.value.upiId" class="payment-detail">
          UPI ID: {{ paymentForm.value.upiId }}
        </div>
        <div *ngIf="paymentForm.value.walletAmount > 0" class="payment-detail">
          Wallet Amount: ₹{{ paymentForm.value.walletAmount | number:'1.0-0' }}
        </div>
      </div>

      <div class="form-actions">
        <button type="button" class="btn btn-secondary" (click)="previousStep()">← BACK</button>
        <button 
          type="button" 
          class="btn btn-primary" 
          (click)="placeOrder()" 
          [disabled]="isProcessing || cartItems.length === 0">
          {{ isProcessing ? 'PROCESSING...' : 'PLACE ORDER' }}
        </button>
      </div>
    </div>
  </div>

  <!-- Step 4: Order Confirmation -->
  <div *ngIf="currentStep === 4 && orderNumber" class="order-confirmation">
    <div class="confirmation-header">
      <div class="success-icon">✓</div>
      <h1>ORDER PLACED SUCCESSFULLY!</h1>
      <h2>ART SPEAKS WHERE WORDS ARE UNABLE TO EXPLAIN.</h2>
    </div>

    <div class="order-details">
      <p>Your order number is: <strong>{{ orderNumber }}</strong></p>
      <p>You will receive an order confirmation email with details of your order and a link to track its progress.</p>
      <p><a href="#" (click)="printOrderConfirmation()">Click here to print a copy of your order confirmation.</a></p>
    </div>

    <div class="confirmation-actions">
      <button type="button" class="btn btn-primary" (click)="continueShopping()">CONTINUE SHOPPING</button>
      <button type="button" class="btn btn-secondary" (click)="trackOrder()">TRACK YOUR ORDER</button>
    </div>

    <div class="rating-section">
      <p>Help Us Make Us Better</p>
      <div class="rating-stars">
        <span *ngFor="let i of [1,2,3,4,5]" class="star">⭐</span>
      </div>
      <button type="button" class="btn btn-outline">RATE YOUR EXPERIENCE</button>
    </div>
  </div>

  <!-- Empty Cart Message -->
  <div *ngIf="cartItems.length === 0 && currentStep === 4" class="empty-cart">
    <h3>Your cart is empty</h3>
    <p>Add some artworks to your cart to proceed with checkout.</p>
    <button type="button" class="btn btn-primary" (click)="continueShopping()">CONTINUE SHOPPING</button>
  </div>
</div>