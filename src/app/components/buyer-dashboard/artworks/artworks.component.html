<!-- Browse Artworks View -->
<div class="dashboard-header">
  <h2>
    Welcome, {{ user()?.full_name | titlecase }}
  </h2>
</div>

<div id="carouselExample" class="carousel slide" data-bs-ride="carousel" data-bs-interval="2000">
  <div class="carousel-inner">
    <div class="carousel-item active">
      <img src="c1.jpg" class="d-block w-100 h-40" alt="Slide 1">
    </div>
    <div class="carousel-item">
      <img src="c2.jpg" class="d-block w-100" alt="Slide 2">
    </div>
    <div class="carousel-item">
      <img src="c4.jpg" class="d-block w-100" alt="Slide 3">
    </div>
  </div>

  <button class="carousel-control-prev" type="button" data-bs-target="#carouselExample" data-bs-slide="prev">
    <span class="carousel-control-prev-icon"></span>
  </button>
  <button class="carousel-control-next" type="button" data-bs-target="#carouselExample" data-bs-slide="next">
    <span class="carousel-control-next-icon"></span>
  </button>
</div>
<div class="content-section">
  <div class="section-header">
    <h2>Browse Artworks</h2>

    <!-- Search Bar -->
    <div class="search-container">
      <input type="text" class="search-input" placeholder="Search by artwork name, artist, or category..."
        [(ngModel)]="searchTerm" (input)="onSearchChange()" />
      <i class="fas fa-search search-icon"></i>
    </div>
  </div>

  <!-- Filters and Sort Section -->
  <div class="filters-section">
    <div class="filters-row">
      <!-- Category Filter -->
      <!-- Category Filter -->
      <div class="filter-group">
        <label for="category">Category:</label>
        <select id="category" [(ngModel)]="selectedCategory" (change)="applyFilters()">
          <option value="">All Categories</option>
          <option *ngFor="let cat of filters.categories" [value]="cat">
            {{ cat | titlecase }}
          </option>
        </select>
      </div>

      <!-- Style Filter -->
      <div class="filter-group">
        <label for="style">Style:</label>
        <select id="style" [(ngModel)]="selectedStyle" (change)="applyFilters()">
          <option value="">All Styles</option>
          <option *ngFor="let style of filters.styles" [value]="style">
            {{ style | titlecase }}
          </option>
        </select>
      </div>


      <!-- Price Range Filter -->
      <div class="filter-group price-range">
        <label>Price Range:</label>
        <div class="price-inputs">
          <input type="number" placeholder="Min" [(ngModel)]="minPrice" (input)="applyFilters()" class="price-input" />
          <span>-</span>
          <input type="number" placeholder="Max" [(ngModel)]="maxPrice" (input)="applyFilters()" class="price-input" />
        </div>
      </div>

      <!-- Sort Options -->
      <div class="filter-group">
        <label for="sort">Sort by:</label>
        <select id="sort" [(ngModel)]="sortBy" (change)="applyFilters()">
          <option value="">Default</option>
          <option value="newest">Newest First</option>
          <option value="price_asc">Price: Low to High</option>
          <option value="price_desc">Price: High to Low</option>
          <option value="popular">Most Popular</option>
        </select>
      </div>

      <!-- Clear Filters Button -->
      <div class="filter-group">
        <button class="clear-filters-btn" (click)="clearFilters()">
          <i class="fas fa-times"></i> Clear All
        </button>
      </div>
    </div>

    <!-- Active Filters Display -->
    <div class="active-filters" *ngIf="hasActiveFilters()">
      <span class="filter-label">Active Filters:</span>
      <span class="filter-tag" *ngIf="searchTerm">
        Search: "{{ searchTerm }}"
        <i class="fas fa-times" (click)="clearSearch()"></i>
      </span>
      <span class="filter-tag" *ngIf="selectedCategory">
        Category: {{ selectedCategory | titlecase }}
        <i class="fas fa-times" (click)="clearCategory()"></i>
      </span>
      <span class="filter-tag" *ngIf="selectedStyle">
        Style: {{ selectedStyle | titlecase }}
        <i class="fas fa-times" (click)="clearStyle()"></i>
      </span>
      <span class="filter-tag" *ngIf="minPrice || maxPrice">
        Price: ${{ minPrice || 0 }} - ${{ maxPrice || 'âˆž' }}
        <i class="fas fa-times" (click)="clearPriceRange()"></i>
      </span>
      <span class="filter-tag" *ngIf="sortBy">
        Sort: {{ getSortLabel(sortBy) }}
        <i class="fas fa-times" (click)="clearSort()"></i>
      </span>
    </div>

    <!-- Results Count -->
    <div class="results-info" *ngIf="!loading">
      <span>{{ filteredArtworks.length }} artwork(s) found</span>
    </div>
  </div>

  <div *ngIf="loading" class="loading-message">Loading artworks...</div>
  <div *ngIf="!loading && errorMessage" class="error-message">{{ errorMessage }}</div>
  <div *ngIf="!loading && !errorMessage && filteredArtworks.length === 0" class="no-artworks-message">
    No artworks found matching your criteria.
  </div>

  <div *ngIf="!loading && !errorMessage && filteredArtworks.length > 0" class="artworks-grid">
    <div class="artwork-card" *ngFor="let artwork of filteredArtworks" (click)="view(artwork)">
      <div class="artwork-image">
        <img [src]="artwork.image ? imageURL + artwork.image : 'assets/default-image.png'" alt="Artwork" />
        <div class="artwork-overlay">
          <button class="action-btn wishlist-btn" [class.active]="isInWishlist(artwork.artwork_id)"
            (click)="toggleWishlist(artwork); $event.stopPropagation()">
            <span class="icon"><i class="fas fa-heart"></i></span>
          </button>
        </div>
      </div>
      <div class="artwork-info">
        <h4>{{ artwork.title }}</h4>
        <p class="artwork-category category-{{ artwork.category_name | lowercase }}">
          {{ artwork.category_name }}
        </p>
        <p class="artwork-style">{{ artwork.style | titlecase }}</p>
        <p class="artwork-description">{{ artwork.description }}</p>
        <!-- <div class="artwork-stats">
          <span class="sales-count">{{ artwork.sales_count }} sold</span>
        </div> -->
        <div class="artwork-footer">
          <span class="artwork-price">{{ artwork.price | currency:'INR':'symbol' }}</span>
          <button class="add-to-cart-btn" (click)="addToCart(artwork);  $event.stopPropagation()">
            Add to Cart
          </button>
        </div>
      </div>
    </div>
  </div>
</div>