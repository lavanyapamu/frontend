<div class="profile-container">
  <div class="profile-header">
    <div class="profile-image-wrap">
      <img *ngIf="imagePreview; else noImage" [src]="imagePreview" alt="Profile" />
      <ng-template #noImage>
        <p>No profile image.</p>
      </ng-template>
    </div>
    <div class="profile-info">
      <h2>{{ profileForm.value.full_name || 'User Name' }}</h2>
      <p>{{ profileForm.value.email || 'user@example.com' }}</p>
    </div>
    <button class="edit-btn" *ngIf="!isEditMode" (click)="enableEdit()">Edit</button>
  </div>

  <form [formGroup]="profileForm" (ngSubmit)="onSubmit()" class="profile-form">
    <div class="form-row">
      <div class="form-group">
        <label>Full Name</label>
        <input class="form-control" formControlName="full_name" [readonly]="!isEditMode" />
      </div>

      <div class="form-group">
        <label>Email</label>
        <input class="form-control" formControlName="email" [readonly]="!isEditMode" />
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label>Phone Number</label>
        <input class="form-control" formControlName="phone_number" [readonly]="!isEditMode" />
      </div>

      <!-- Earnings shown only for Artist -->
      <div class="form-group" *ngIf="isArtist">
        <label>Total Earnings</label>
        <input class="form-control" [value]="earnings" readonly />
      </div>
    </div>

    <div class="form-group" *ngIf="isEditMode">
      <label>Profile Image</label>
      <input type="file" (change)="onImageChange($event)" class="form-control" />
    </div>

    <button type="submit" class="update-btn" *ngIf="isEditMode">Update Profile</button>
  </form>
  <div class="change">
    <!-- Show only button if form is hidden -->
    <button class="but" *ngIf="!showChangePassword" (click)="toggleChangePassword()">
      Change Password
    </button>

    <!-- Show form if toggled -->
    <form *ngIf="showChangePassword" (ngSubmit)="onChangePassword()" class="password-form">

      <!-- Current Password -->
      <div class="form-group position-relative">
        <label>Current Password</label>
        <input [type]="showCurrentPassword ? 'text' : 'password'" [(ngModel)]="passwordForm.currentPassword"
          name="currentPassword" class="form-control" required />
        <i class="fa" [ngClass]="showCurrentPassword ? 'fa-eye-slash' : 'fa-eye'"
          (click)="showCurrentPassword = !showCurrentPassword"
          style="position:absolute; right:10px; top:38px; cursor:pointer;">
        </i>
      </div>

      <!-- New Password -->
      <div class="form-group position-relative">
        <label>New Password</label>
        <input [type]="showNewPassword ? 'text' : 'password'" [(ngModel)]="passwordForm.newPassword" name="newPassword"
          class="form-control" required />
        <i class="fa" [ngClass]="showNewPassword ? 'fa-eye-slash' : 'fa-eye'"
          (click)="showNewPassword = !showNewPassword" style="position:absolute; right:10px; top:38px; cursor:pointer;">
        </i>
      </div>

      <button type="submit" class="but">Update Password</button>
      <button type="button" class="but cancel" (click)="toggleChangePassword()">Cancel</button>
    </form>
  </div>
</div>